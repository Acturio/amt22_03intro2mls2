<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 5 Workflowsets | AMAT- Ciencia de Datos y Machine Learning 2</title>
  <meta name="description" content="AMAT Curso 2 : Ciencia de Datos y Machine Learning 2" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 5 Workflowsets | AMAT- Ciencia de Datos y Machine Learning 2" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="AMAT Curso 2 : Ciencia de Datos y Machine Learning 2" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 5 Workflowsets | AMAT- Ciencia de Datos y Machine Learning 2" />
  
  <meta name="twitter:description" content="AMAT Curso 2 : Ciencia de Datos y Machine Learning 2" />
  

<meta name="author" content="Karina Lizette Gamboa Puente" />
<meta name="author" content="Oscar Arturo Bringas López" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bagging-boosting.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><img src="img/amat-logo.png" width="280"></a></li|
|:-:|  
<center>Ciencia de Datos y Machine Learning 2</center>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>BIENVENIDA</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objetivo"><i class="fa fa-check"></i>Objetivo</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructores"><i class="fa fa-check"></i>Instructores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ciencia-de-datos-en-r"><i class="fa fa-check"></i>Ciencia de Datos en R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-curso-actual"><i class="fa fa-check"></i>Estructura del curso actual</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#alcances-del-curso"><i class="fa fa-check"></i>Alcances del curso</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#duración-y-evaluación-del-curso"><i class="fa fa-check"></i>Duración y evaluación del curso</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#recursos-y-dinámica-de-clase"><i class="fa fa-check"></i>Recursos y dinámica de clase</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="repaso.html"><a href="repaso.html"><i class="fa fa-check"></i><b>1</b> Repaso</a>
<ul>
<li class="chapter" data-level="1.1" data-path="repaso.html"><a href="repaso.html#machine-learning"><i class="fa fa-check"></i><b>1.1</b> Machine Learning</a></li>
<li class="chapter" data-level="1.2" data-path="repaso.html"><a href="repaso.html#tipos-de-aprendizaje"><i class="fa fa-check"></i><b>1.2</b> Tipos de aprendizaje</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="repaso.html"><a href="repaso.html#aprendizaje-supervisado"><i class="fa fa-check"></i><b>1.2.1</b> Aprendizaje supervisado</a></li>
<li class="chapter" data-level="1.2.2" data-path="repaso.html"><a href="repaso.html#aprendizaje-no-supervisado"><i class="fa fa-check"></i><b>1.2.2</b> Aprendizaje no supervisado</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="repaso.html"><a href="repaso.html#errores-sesgo-vs-varianza"><i class="fa fa-check"></i><b>1.3</b> Errores: Sesgo vs varianza</a></li>
<li class="chapter" data-level="1.4" data-path="repaso.html"><a href="repaso.html#partición-de-datos"><i class="fa fa-check"></i><b>1.4</b> Partición de datos</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="repaso.html"><a href="repaso.html#métodos-comunes-para-particionar-datos"><i class="fa fa-check"></i><b>1.4.1</b> Métodos comunes para particionar datos</a></li>
<li class="chapter" data-level="1.4.2" data-path="repaso.html"><a href="repaso.html#conjunto-de-validación"><i class="fa fa-check"></i><b>1.4.2</b> Conjunto de validación</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="repaso.html"><a href="repaso.html#recetas-y-tratamiento-de-datos"><i class="fa fa-check"></i><b>1.5</b> Recetas y tratamiento de datos</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="repaso.html"><a href="repaso.html#pre-procesamiento-de-datos"><i class="fa fa-check"></i><b>1.5.1</b> Pre-procesamiento de datos</a></li>
<li class="chapter" data-level="1.5.2" data-path="repaso.html"><a href="repaso.html#recetas"><i class="fa fa-check"></i><b>1.5.2</b> Recetas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="feature-engineering.html"><a href="feature-engineering.html"><i class="fa fa-check"></i><b>2</b> Feature Engineering</a>
<ul>
<li class="chapter" data-level="2.1" data-path="feature-engineering.html"><a href="feature-engineering.html#regresión-polinomial"><i class="fa fa-check"></i><b>2.1</b> Regresión polinomial</a></li>
<li class="chapter" data-level="2.2" data-path="feature-engineering.html"><a href="feature-engineering.html#análisis-de-componentes-principales"><i class="fa fa-check"></i><b>2.2</b> Análisis de Componentes Principales</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="feature-engineering.html"><a href="feature-engineering.html#eigenvalores-y-eigenvectores"><i class="fa fa-check"></i><b>2.2.1</b> Eigenvalores y eigenvectores</a></li>
<li class="chapter" data-level="2.2.2" data-path="feature-engineering.html"><a href="feature-engineering.html#implementación-en-r"><i class="fa fa-check"></i><b>2.2.2</b> Implementación en R</a></li>
<li class="chapter" data-level="2.2.3" data-path="feature-engineering.html"><a href="feature-engineering.html#representación-gráfica"><i class="fa fa-check"></i><b>2.2.3</b> Representación gráfica</a></li>
<li class="chapter" data-level="2.2.4" data-path="feature-engineering.html"><a href="feature-engineering.html#cuántas-componentes-retener"><i class="fa fa-check"></i><b>2.2.4</b> ¿Cuántas componentes retener?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="feature-engineering.html"><a href="feature-engineering.html#imputación-knn"><i class="fa fa-check"></i><b>2.3</b> Imputación KNN</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="feature-engineering.html"><a href="feature-engineering.html#ventajas-y-limitaciones-del-clasificador-knn"><i class="fa fa-check"></i><b>2.3.1</b> <strong>Ventajas y limitaciones del Clasificador KNN</strong></a></li>
<li class="chapter" data-level="2.3.2" data-path="feature-engineering.html"><a href="feature-engineering.html#implementación-en-r-1"><i class="fa fa-check"></i><b>2.3.2</b> Implementación en R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="feature-engineering.html"><a href="feature-engineering.html#ejercicios"><i class="fa fa-check"></i><b>2.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html"><i class="fa fa-check"></i><b>3</b> Support Vector Machine (SVM / SVR)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#maximum-margin-classifier"><i class="fa fa-check"></i><b>3.1</b> Maximum Margin Classifier</a></li>
<li class="chapter" data-level="3.2" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#support-vector-classifiers"><i class="fa fa-check"></i><b>3.2</b> Support Vector Classifiers</a></li>
<li class="chapter" data-level="3.3" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#support-vector-machine"><i class="fa fa-check"></i><b>3.3</b> Support Vector Machine</a></li>
<li class="chapter" data-level="3.4" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#el-truco-del-kernel"><i class="fa fa-check"></i><b>3.4</b> El truco del Kernel</a></li>
<li class="chapter" data-level="3.5" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#support-vector-regression"><i class="fa fa-check"></i><b>3.5</b> Support Vector Regression</a></li>
<li class="chapter" data-level="3.6" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#ventajas-y-desventajas"><i class="fa fa-check"></i><b>3.6</b> Ventajas y desventajas</a></li>
<li class="chapter" data-level="3.7" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#ajuste-del-modelo-con-r"><i class="fa fa-check"></i><b>3.7</b> Ajuste del modelo con R</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#implementación-de-svr-en-r"><i class="fa fa-check"></i><b>3.7.1</b> Implementación de SVR en R</a></li>
<li class="chapter" data-level="3.7.2" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#implementación-de-svm-en-r"><i class="fa fa-check"></i><b>3.7.2</b> Implementación de SVM en R</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="support-vector-machine-svm-svr.html"><a href="support-vector-machine-svm-svr.html#ejercicios-1"><i class="fa fa-check"></i><b>3.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bagging-boosting.html"><a href="bagging-boosting.html"><i class="fa fa-check"></i><b>4</b> Bagging &amp; Boosting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="bagging-boosting.html"><a href="bagging-boosting.html#aprendizaje-conjunto"><i class="fa fa-check"></i><b>4.1</b> Aprendizaje conjunto</a></li>
<li class="chapter" data-level="4.2" data-path="bagging-boosting.html"><a href="bagging-boosting.html#bagging-vs.-boosting"><i class="fa fa-check"></i><b>4.2</b> Bagging vs. boosting</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="bagging-boosting.html"><a href="bagging-boosting.html#error-out-of-bag"><i class="fa fa-check"></i><b>4.2.1</b> Error Out-Of-Bag</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="bagging-boosting.html"><a href="bagging-boosting.html#algoritmo-bagging"><i class="fa fa-check"></i><b>4.3</b> Algoritmo Bagging</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="bagging-boosting.html"><a href="bagging-boosting.html#ventajas-y-desventajas-de-bagging"><i class="fa fa-check"></i><b>4.3.1</b> Ventajas y desventajas de bagging</a></li>
<li class="chapter" data-level="4.3.2" data-path="bagging-boosting.html"><a href="bagging-boosting.html#aplicaciónes-de-bagging"><i class="fa fa-check"></i><b>4.3.2</b> Aplicaciónes de Bagging</a></li>
<li class="chapter" data-level="4.3.3" data-path="bagging-boosting.html"><a href="bagging-boosting.html#implementación-en-r-2"><i class="fa fa-check"></i><b>4.3.3</b> Implementación en <em>R</em></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="bagging-boosting.html"><a href="bagging-boosting.html#algoritmo-boosting"><i class="fa fa-check"></i><b>4.4</b> Algoritmo Boosting</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="bagging-boosting.html"><a href="bagging-boosting.html#predicciones-de-boosting"><i class="fa fa-check"></i><b>4.4.1</b> Predicciones de <em>Boosting</em></a></li>
<li class="chapter" data-level="4.4.2" data-path="bagging-boosting.html"><a href="bagging-boosting.html#modelos-boosting"><i class="fa fa-check"></i><b>4.4.2</b> Modelos <em>Boosting</em></a></li>
<li class="chapter" data-level="4.4.3" data-path="bagging-boosting.html"><a href="bagging-boosting.html#implementación-en-r-3"><i class="fa fa-check"></i><b>4.4.3</b> Implementación en R</a></li>
<li class="chapter" data-level="4.4.4" data-path="bagging-boosting.html"><a href="bagging-boosting.html#xgboost-para-regresión"><i class="fa fa-check"></i><b>4.4.4</b> XGBoost para regresión</a></li>
<li class="chapter" data-level="4.4.5" data-path="bagging-boosting.html"><a href="bagging-boosting.html#xgboost-para-clasificación"><i class="fa fa-check"></i><b>4.4.5</b> XGBoost para clasificación</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="bagging-boosting.html"><a href="bagging-boosting.html#ejercicios-2"><i class="fa fa-check"></i><b>4.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="workflowsets.html"><a href="workflowsets.html"><i class="fa fa-check"></i><b>5</b> Workflowsets</a>
<ul>
<li class="chapter" data-level="5.1" data-path="workflowsets.html"><a href="workflowsets.html#múltiples-recetas"><i class="fa fa-check"></i><b>5.1</b> Múltiples recetas</a></li>
<li class="chapter" data-level="5.2" data-path="workflowsets.html"><a href="workflowsets.html#múltiples-modelos"><i class="fa fa-check"></i><b>5.2</b> Múltiples modelos</a></li>
<li class="chapter" data-level="5.3" data-path="workflowsets.html"><a href="workflowsets.html#creación-de-workflowset"><i class="fa fa-check"></i><b>5.3</b> Creación de workflowset</a></li>
<li class="chapter" data-level="5.4" data-path="workflowsets.html"><a href="workflowsets.html#ajuste-y-evaluación-de-modelos"><i class="fa fa-check"></i><b>5.4</b> Ajuste y evaluación de modelos</a></li>
<li class="chapter" data-level="5.5" data-path="workflowsets.html"><a href="workflowsets.html#extracción-de-modelos"><i class="fa fa-check"></i><b>5.5</b> Extracción de modelos</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="workflowsets.html"><a href="workflowsets.html#selección-de-modelo"><i class="fa fa-check"></i><b>5.5.1</b> Selección de modelo</a></li>
<li class="chapter" data-level="5.5.2" data-path="workflowsets.html"><a href="workflowsets.html#método-de-carrera"><i class="fa fa-check"></i><b>5.5.2</b> Método de carrera</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="./"><img src="img/amat-logo.png" width="280"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AMAT- Ciencia de Datos y Machine Learning 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="workflowsets" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Capítulo 5</span> Workflowsets<a href="workflowsets.html#workflowsets" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Es común no sepamos ni remotamente cuál es el mejor modelo que podríamos implementar al iniciar un proyecto con datos que nunca antes hemos visto. Es posible que un profesional de datos deba seleccionar muchas combinaciones de modelos y preprocesadores. También es posible tener poco o ningún conocimiento a priori sobre qué método funcionará mejor con un nuevo conjunto de datos.</p>
<blockquote>
<p>Una buena estrategia es dedicar un esfuerzo inicial a probar una variedad de enfoques de modelado, determinar qué funciona mejor y luego invertir tiempo adicional ajustando / optimizando un pequeño conjunto de modelos.</p>
</blockquote>
<div id="múltiples-recetas" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Múltiples recetas<a href="workflowsets.html#múltiples-recetas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Algunos modelos requieren predictores que se han centrado y escalado, por lo que algunos flujos de trabajo de modelos requerirán recetas con estos pasos de preprocesamiento. Para otros modelos, crear interacciones cuadráticas y bidireccionales. Para estos fines, creamos múltiples recetas:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="workflowsets.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb186-2"><a href="workflowsets.html#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="workflowsets.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ames)</span>
<span id="cb186-4"><a href="workflowsets.html#cb186-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-5"><a href="workflowsets.html#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4595</span>)</span>
<span id="cb186-6"><a href="workflowsets.html#cb186-6" aria-hidden="true" tabindex="-1"></a>ames_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(ames, <span class="at">prop =</span> <span class="fl">0.75</span>)</span>
<span id="cb186-7"><a href="workflowsets.html#cb186-7" aria-hidden="true" tabindex="-1"></a>ames_train <span class="ot">&lt;-</span> <span class="fu">training</span>(ames_split)</span>
<span id="cb186-8"><a href="workflowsets.html#cb186-8" aria-hidden="true" tabindex="-1"></a>ames_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(ames_split)</span>
<span id="cb186-9"><a href="workflowsets.html#cb186-9" aria-hidden="true" tabindex="-1"></a>ames_folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(ames_train)</span></code></pre></div>
<ul>
<li><strong>Receta Original</strong></li>
</ul>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="workflowsets.html#cb187-1" aria-hidden="true" tabindex="-1"></a>receta_original <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> . , <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb187-2"><a href="workflowsets.html#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Alley) <span class="sc">%&gt;%</span></span>
<span id="cb187-3"><a href="workflowsets.html#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">Year_Remod =</span> Year_Remod_Add) <span class="sc">%&gt;%</span> </span>
<span id="cb187-4"><a href="workflowsets.html#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">ThirdSsn_Porch =</span> Three_season_porch) <span class="sc">%&gt;%</span> </span>
<span id="cb187-5"><a href="workflowsets.html#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ratio</span>(Bedroom_AbvGr, <span class="at">denom =</span> <span class="fu">denom_vars</span>(Gr_Liv_Area)) <span class="sc">%&gt;%</span> </span>
<span id="cb187-6"><a href="workflowsets.html#cb187-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(</span>
<span id="cb187-7"><a href="workflowsets.html#cb187-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_House =</span> Year_Sold <span class="sc">-</span> Year_Remod,</span>
<span id="cb187-8"><a href="workflowsets.html#cb187-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">TotalSF   =</span> Gr_Liv_Area <span class="sc">+</span> Total_Bsmt_SF,</span>
<span id="cb187-9"><a href="workflowsets.html#cb187-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">AvgRoomSF   =</span> Gr_Liv_Area <span class="sc">/</span> TotRms_AbvGrd,</span>
<span id="cb187-10"><a href="workflowsets.html#cb187-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pool =</span> <span class="fu">if_else</span>(Pool_Area <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb187-11"><a href="workflowsets.html#cb187-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exter_Cond =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Exter_Cond, <span class="at">Good =</span> <span class="fu">c</span>(<span class="st">&quot;Typical&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Excellent&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb187-12"><a href="workflowsets.html#cb187-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(Exter_Cond, <span class="at">ref_level =</span> <span class="st">&quot;Good&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb187-13"><a href="workflowsets.html#cb187-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>(), <span class="sc">-</span><span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb187-14"><a href="workflowsets.html#cb187-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb187-15"><a href="workflowsets.html#cb187-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Second_Flr_SF<span class="sc">:</span>First_Flr_SF) <span class="sc">%&gt;%</span> </span>
<span id="cb187-16"><a href="workflowsets.html#cb187-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Bsmt_Cond&quot;</span>)<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span> </span>
<span id="cb187-17"><a href="workflowsets.html#cb187-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(</span>
<span id="cb187-18"><a href="workflowsets.html#cb187-18" aria-hidden="true" tabindex="-1"></a>    First_Flr_SF, Second_Flr_SF, Year_Remod,</span>
<span id="cb187-19"><a href="workflowsets.html#cb187-19" aria-hidden="true" tabindex="-1"></a>    Bsmt_Full_Bath, Bsmt_Half_Bath, </span>
<span id="cb187-20"><a href="workflowsets.html#cb187-20" aria-hidden="true" tabindex="-1"></a>    Kitchen_AbvGr, BsmtFin_Type_1_Unf, </span>
<span id="cb187-21"><a href="workflowsets.html#cb187-21" aria-hidden="true" tabindex="-1"></a>    Total_Bsmt_SF, Kitchen_AbvGr, Pool_Area, </span>
<span id="cb187-22"><a href="workflowsets.html#cb187-22" aria-hidden="true" tabindex="-1"></a>    Gr_Liv_Area, Sale_Type_Oth, Sale_Type_VWD</span>
<span id="cb187-23"><a href="workflowsets.html#cb187-23" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb187-24"><a href="workflowsets.html#cb187-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-25"><a href="workflowsets.html#cb187-25" aria-hidden="true" tabindex="-1"></a>receta_original_prep <span class="ot">&lt;-</span> receta_original <span class="sc">%&gt;%</span> <span class="fu">prep</span>()</span></code></pre></div>
<ul>
<li><strong>Receta PCA:</strong></li>
</ul>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="workflowsets.html#cb188-1" aria-hidden="true" tabindex="-1"></a>receta_knn <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> . , <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb188-2"><a href="workflowsets.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Alley) <span class="sc">%&gt;%</span></span>
<span id="cb188-3"><a href="workflowsets.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Pool_QC) <span class="sc">%&gt;%</span></span>
<span id="cb188-4"><a href="workflowsets.html#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Misc_Feature) <span class="sc">%&gt;%</span></span>
<span id="cb188-5"><a href="workflowsets.html#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Fence) <span class="sc">%&gt;%</span></span>
<span id="cb188-6"><a href="workflowsets.html#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Garage_Finish) <span class="sc">%&gt;%</span></span>
<span id="cb188-7"><a href="workflowsets.html#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Garage_Cond) <span class="sc">%&gt;%</span></span>
<span id="cb188-8"><a href="workflowsets.html#cb188-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Garage_Type) <span class="sc">%&gt;%</span></span>
<span id="cb188-9"><a href="workflowsets.html#cb188-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Bsmt_Exposure) <span class="sc">%&gt;%</span></span>
<span id="cb188-10"><a href="workflowsets.html#cb188-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Bsmt_Cond) <span class="sc">%&gt;%</span></span>
<span id="cb188-11"><a href="workflowsets.html#cb188-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(BsmtFin_Type_1) <span class="sc">%&gt;%</span></span>
<span id="cb188-12"><a href="workflowsets.html#cb188-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(BsmtFin_Type_2) <span class="sc">%&gt;%</span></span>
<span id="cb188-13"><a href="workflowsets.html#cb188-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Mas_Vnr_Type) <span class="sc">%&gt;%</span></span>
<span id="cb188-14"><a href="workflowsets.html#cb188-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Electrical) <span class="sc">%&gt;%</span></span>
<span id="cb188-15"><a href="workflowsets.html#cb188-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_knn</span>(</span>
<span id="cb188-16"><a href="workflowsets.html#cb188-16" aria-hidden="true" tabindex="-1"></a>    Mas_Vnr_Area, Lot_Frontage, </span>
<span id="cb188-17"><a href="workflowsets.html#cb188-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">impute_with=</span> <span class="fu">all_predictors</span>(),</span>
<span id="cb188-18"><a href="workflowsets.html#cb188-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">neighbors =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-19"><a href="workflowsets.html#cb188-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">Year_Remod =</span> Year_Remod_Add) <span class="sc">%&gt;%</span> </span>
<span id="cb188-20"><a href="workflowsets.html#cb188-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">ThirdSsn_Porch =</span> Three_season_porch) <span class="sc">%&gt;%</span> </span>
<span id="cb188-21"><a href="workflowsets.html#cb188-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ratio</span>(Bedroom_AbvGr, <span class="at">denom =</span> <span class="fu">denom_vars</span>(Gr_Liv_Area)) <span class="sc">%&gt;%</span> </span>
<span id="cb188-22"><a href="workflowsets.html#cb188-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(</span>
<span id="cb188-23"><a href="workflowsets.html#cb188-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_House =</span> Year_Sold <span class="sc">-</span> Year_Remod,</span>
<span id="cb188-24"><a href="workflowsets.html#cb188-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">TotalSF   =</span> Gr_Liv_Area <span class="sc">+</span> Total_Bsmt_SF,</span>
<span id="cb188-25"><a href="workflowsets.html#cb188-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">AvgRoomSF   =</span> Gr_Liv_Area <span class="sc">/</span> TotRms_AbvGrd,</span>
<span id="cb188-26"><a href="workflowsets.html#cb188-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pool =</span> <span class="fu">if_else</span>(Pool_Area <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb188-27"><a href="workflowsets.html#cb188-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exter_Cond =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Exter_Cond, <span class="at">Good =</span> <span class="fu">c</span>(<span class="st">&quot;Typical&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Excellent&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb188-28"><a href="workflowsets.html#cb188-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(Exter_Cond, <span class="at">ref_level =</span> <span class="st">&quot;Good&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb188-29"><a href="workflowsets.html#cb188-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>(), <span class="sc">-</span><span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb188-30"><a href="workflowsets.html#cb188-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb188-31"><a href="workflowsets.html#cb188-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Second_Flr_SF<span class="sc">:</span>First_Flr_SF) <span class="sc">%&gt;%</span> </span>
<span id="cb188-32"><a href="workflowsets.html#cb188-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Bsmt_Cond&quot;</span>)<span class="sc">:</span>TotRms_AbvGrd) </span>
<span id="cb188-33"><a href="workflowsets.html#cb188-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-34"><a href="workflowsets.html#cb188-34" aria-hidden="true" tabindex="-1"></a>receta_knn_prep <span class="ot">&lt;-</span> receta_knn <span class="sc">%&gt;%</span> <span class="fu">prep</span>()</span></code></pre></div>
<ul>
<li><strong>Receta Grande:</strong></li>
</ul>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="workflowsets.html#cb189-1" aria-hidden="true" tabindex="-1"></a>receta_grande <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> . , <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb189-2"><a href="workflowsets.html#cb189-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Alley) <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="workflowsets.html#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Fence) <span class="sc">%&gt;%</span></span>
<span id="cb189-4"><a href="workflowsets.html#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Garage_Type) <span class="sc">%&gt;%</span></span>
<span id="cb189-5"><a href="workflowsets.html#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Garage_Finish) <span class="sc">%&gt;%</span></span>
<span id="cb189-6"><a href="workflowsets.html#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Garage_Cond) <span class="sc">%&gt;%</span></span>
<span id="cb189-7"><a href="workflowsets.html#cb189-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Bsmt_Cond) <span class="sc">%&gt;%</span></span>
<span id="cb189-8"><a href="workflowsets.html#cb189-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Bsmt_Exposure) <span class="sc">%&gt;%</span></span>
<span id="cb189-9"><a href="workflowsets.html#cb189-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(BsmtFin_Type_1) <span class="sc">%&gt;%</span></span>
<span id="cb189-10"><a href="workflowsets.html#cb189-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(BsmtFin_Type_2) <span class="sc">%&gt;%</span></span>
<span id="cb189-11"><a href="workflowsets.html#cb189-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Mas_Vnr_Type) <span class="sc">%&gt;%</span></span>
<span id="cb189-12"><a href="workflowsets.html#cb189-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Electrical) <span class="sc">%&gt;%</span></span>
<span id="cb189-13"><a href="workflowsets.html#cb189-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Heating_QC) <span class="sc">%&gt;%</span></span>
<span id="cb189-14"><a href="workflowsets.html#cb189-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_unknown</span>(Pool_QC) <span class="sc">%&gt;%</span> </span>
<span id="cb189-15"><a href="workflowsets.html#cb189-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">Year_Remod =</span> Year_Remod_Add) <span class="sc">%&gt;%</span> </span>
<span id="cb189-16"><a href="workflowsets.html#cb189-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rename</span>(<span class="at">ThirdSsn_Porch =</span> Three_season_porch) <span class="sc">%&gt;%</span> </span>
<span id="cb189-17"><a href="workflowsets.html#cb189-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ratio</span>(Bedroom_AbvGr, <span class="at">denom =</span> <span class="fu">denom_vars</span>(Gr_Liv_Area)) <span class="sc">%&gt;%</span> </span>
<span id="cb189-18"><a href="workflowsets.html#cb189-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_ratio</span>(Second_Flr_SF, <span class="at">denom =</span> <span class="fu">denom_vars</span>(First_Flr_SF)) <span class="sc">%&gt;%</span> </span>
<span id="cb189-19"><a href="workflowsets.html#cb189-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_mutate</span>(</span>
<span id="cb189-20"><a href="workflowsets.html#cb189-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">TotalBaths =</span> Full_Bath <span class="sc">+</span> Bsmt_Full_Bath <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> (Half_Bath <span class="sc">+</span> Bsmt_Half_Bath),</span>
<span id="cb189-21"><a href="workflowsets.html#cb189-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_House =</span> Year_Sold <span class="sc">-</span> Year_Remod,</span>
<span id="cb189-22"><a href="workflowsets.html#cb189-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">TotalSF =</span> Gr_Liv_Area <span class="sc">+</span> Total_Bsmt_SF,</span>
<span id="cb189-23"><a href="workflowsets.html#cb189-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">AvgRoomSF =</span> Gr_Liv_Area <span class="sc">/</span> TotRms_AbvGrd,</span>
<span id="cb189-24"><a href="workflowsets.html#cb189-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Porch_SF =</span> Enclosed_Porch <span class="sc">+</span> ThirdSsn_Porch <span class="sc">+</span> Open_Porch_SF,</span>
<span id="cb189-25"><a href="workflowsets.html#cb189-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Porch =</span> <span class="fu">factor</span>(Porch_SF <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb189-26"><a href="workflowsets.html#cb189-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pool =</span> <span class="fu">if_else</span>(Pool_Area <span class="sc">&gt;</span> <span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb189-27"><a href="workflowsets.html#cb189-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exter_Cond =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Exter_Cond, <span class="at">Good =</span> <span class="fu">c</span>(<span class="st">&quot;Typical&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Excellent&quot;</span>)),</span>
<span id="cb189-28"><a href="workflowsets.html#cb189-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Condition_1 =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(</span>
<span id="cb189-29"><a href="workflowsets.html#cb189-29" aria-hidden="true" tabindex="-1"></a>      Condition_1, </span>
<span id="cb189-30"><a href="workflowsets.html#cb189-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">Artery_Feedr =</span> <span class="fu">c</span>(<span class="st">&quot;Feedr&quot;</span>, <span class="st">&quot;Artery&quot;</span>), </span>
<span id="cb189-31"><a href="workflowsets.html#cb189-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">Railr =</span> <span class="fu">c</span>(<span class="st">&quot;RRAn&quot;</span>, <span class="st">&quot;RRNn&quot;</span>, <span class="st">&quot;RRNe&quot;</span>, <span class="st">&quot;RRAe&quot;</span>),</span>
<span id="cb189-32"><a href="workflowsets.html#cb189-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">Norm =</span> <span class="st">&quot;Norm&quot;</span>,</span>
<span id="cb189-33"><a href="workflowsets.html#cb189-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">Pos =</span> <span class="fu">c</span>(<span class="st">&quot;PosN&quot;</span>, <span class="st">&quot;PosA&quot;</span>)), </span>
<span id="cb189-34"><a href="workflowsets.html#cb189-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Land_Slope =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Land_Slope, <span class="at">Mod_Sev =</span> <span class="fu">c</span>(<span class="st">&quot;Mod&quot;</span>, <span class="st">&quot;Sev&quot;</span>)),</span>
<span id="cb189-35"><a href="workflowsets.html#cb189-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Land_Contour =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Land_Contour, <span class="at">Low_HLS =</span> <span class="fu">c</span>(<span class="st">&quot;Low&quot;</span>,<span class="st">&quot;HLS&quot;</span>), <span class="at">Bnk_Lvl =</span> <span class="fu">c</span>(<span class="st">&quot;Lvl&quot;</span>,<span class="st">&quot;Bnk&quot;</span>)),</span>
<span id="cb189-36"><a href="workflowsets.html#cb189-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lot_Shape =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Lot_Shape, <span class="at">IRREG =</span> <span class="fu">c</span>(<span class="st">&quot;Slightly_Irregular&quot;</span>, <span class="st">&quot;Moderately_Irregular&quot;</span>, <span class="st">&quot;Irregular&quot;</span>)),</span>
<span id="cb189-37"><a href="workflowsets.html#cb189-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Bsmt_Cond =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Bsmt_Cond, <span class="at">Exc =</span> <span class="fu">c</span>(<span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Excellent&quot;</span>)),</span>
<span id="cb189-38"><a href="workflowsets.html#cb189-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">BsmtFin_Type_1 =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(BsmtFin_Type_1, <span class="at">Rec_BLQ =</span> <span class="fu">c</span>(<span class="st">&quot;Rec&quot;</span>, <span class="st">&quot;BLQ&quot;</span>)),</span>
<span id="cb189-39"><a href="workflowsets.html#cb189-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">BsmtFin_Type_2 =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(BsmtFin_Type_2, <span class="at">Rec_BLQ =</span> <span class="fu">c</span>(<span class="st">&quot;Rec&quot;</span>, <span class="st">&quot;BLQ&quot;</span>,<span class="st">&quot;LwQ&quot;</span>)),</span>
<span id="cb189-40"><a href="workflowsets.html#cb189-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Neighborhood =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(</span>
<span id="cb189-41"><a href="workflowsets.html#cb189-41" aria-hidden="true" tabindex="-1"></a>      Neighborhood, </span>
<span id="cb189-42"><a href="workflowsets.html#cb189-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">NoRidge_GrnHill =</span> <span class="fu">c</span>(<span class="st">&quot;Northridge&quot;</span>, <span class="st">&quot;Green_Hills&quot;</span>),</span>
<span id="cb189-43"><a href="workflowsets.html#cb189-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">Crawfor_Greens =</span> <span class="fu">c</span>(<span class="st">&quot;Crawford&quot;</span>, <span class="st">&quot;Greens&quot;</span>),</span>
<span id="cb189-44"><a href="workflowsets.html#cb189-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">Blueste_Mitchel =</span> <span class="fu">c</span>(<span class="st">&quot;Blueste&quot;</span>, <span class="st">&quot;Mitchell&quot;</span>),</span>
<span id="cb189-45"><a href="workflowsets.html#cb189-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">Blmngtn_CollgCr =</span> <span class="fu">c</span>(<span class="st">&quot;Bloomington_Heights&quot;</span>, <span class="st">&quot;College_Creek&quot;</span>),</span>
<span id="cb189-46"><a href="workflowsets.html#cb189-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">NPkVill_NAmes =</span> <span class="fu">c</span>(<span class="st">&quot;Northpark_Villa&quot;</span>, <span class="st">&quot;North_Ames&quot;</span>),</span>
<span id="cb189-47"><a href="workflowsets.html#cb189-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">Veenker_StoneBr =</span> <span class="fu">c</span>(<span class="st">&quot;Veenker&quot;</span>, <span class="st">&quot;Stone_Brook&quot;</span>),</span>
<span id="cb189-48"><a href="workflowsets.html#cb189-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">BrDale_IDOTRR =</span> <span class="fu">c</span>(<span class="st">&quot;Briardale&quot;</span>, <span class="st">&quot;Iowa_DOT_and_Rail_Road&quot;</span>),</span>
<span id="cb189-49"><a href="workflowsets.html#cb189-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">SWISU_Sawyer =</span> <span class="fu">c</span>(<span class="st">&quot;South_and_West_of_Iowa_State_University&quot;</span>, <span class="st">&quot;Sawyer&quot;</span>),</span>
<span id="cb189-50"><a href="workflowsets.html#cb189-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">ClearCr_Somerst =</span> <span class="fu">c</span>(<span class="st">&quot;Clear_Creek&quot;</span>, <span class="st">&quot;Somerset&quot;</span>)),</span>
<span id="cb189-51"><a href="workflowsets.html#cb189-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Heating =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(</span>
<span id="cb189-52"><a href="workflowsets.html#cb189-52" aria-hidden="true" tabindex="-1"></a>      Heating, <span class="at">Grav_Wall =</span> <span class="fu">c</span>(<span class="st">&quot;Grav&quot;</span>, <span class="st">&quot;Wall&quot;</span>),</span>
<span id="cb189-53"><a href="workflowsets.html#cb189-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">GasA_W =</span> <span class="fu">c</span>(<span class="st">&quot;GasA&quot;</span>, <span class="st">&quot;GasW&quot;</span>, <span class="st">&quot;OthW&quot;</span>)),</span>
<span id="cb189-54"><a href="workflowsets.html#cb189-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">MS_Zoning =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(</span>
<span id="cb189-55"><a href="workflowsets.html#cb189-55" aria-hidden="true" tabindex="-1"></a>      MS_Zoning, <span class="at">I_R_M_H =</span> <span class="fu">c</span>(<span class="st">&quot;Residential_Medium_Density&quot;</span>, <span class="st">&quot;I_all&quot;</span>, <span class="st">&quot;Residential_High_Density&quot;</span> )),</span>
<span id="cb189-56"><a href="workflowsets.html#cb189-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">Bldg_Type =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Bldg_Type, <span class="at">Du_Tu =</span> <span class="fu">c</span>(<span class="st">&quot;Duplex&quot;</span>, <span class="st">&quot;Twnhs&quot;</span>)),</span>
<span id="cb189-57"><a href="workflowsets.html#cb189-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Foundation =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(Foundation, <span class="at">Wood_Stone =</span> <span class="fu">c</span>(<span class="st">&quot;Wood&quot;</span>, <span class="st">&quot;Stone&quot;</span>)),</span>
<span id="cb189-58"><a href="workflowsets.html#cb189-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">Functional =</span> forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(</span>
<span id="cb189-59"><a href="workflowsets.html#cb189-59" aria-hidden="true" tabindex="-1"></a>      Functional, <span class="at">Min =</span> <span class="fu">c</span>(<span class="st">&quot;Min1&quot;</span>, <span class="st">&quot;Min2&quot;</span>), <span class="at">Maj =</span> <span class="fu">c</span>(<span class="st">&quot;Maj1&quot;</span>, <span class="st">&quot;Maj2&quot;</span>, <span class="st">&quot;Mod&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb189-60"><a href="workflowsets.html#cb189-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(Exter_Cond, <span class="at">ref_level =</span> <span class="st">&quot;Good&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb189-61"><a href="workflowsets.html#cb189-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_relevel</span>(Condition_1, <span class="at">ref_level =</span> <span class="st">&quot;Norm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb189-62"><a href="workflowsets.html#cb189-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>(), <span class="sc">-</span><span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb189-63"><a href="workflowsets.html#cb189-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb189-64"><a href="workflowsets.html#cb189-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Second_Flr_SF<span class="sc">:</span>Bedroom_AbvGr) <span class="sc">%&gt;%</span></span>
<span id="cb189-65"><a href="workflowsets.html#cb189-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> TotalSF<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span></span>
<span id="cb189-66"><a href="workflowsets.html#cb189-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Age_House<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span></span>
<span id="cb189-67"><a href="workflowsets.html#cb189-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> Second_Flr_SF<span class="sc">:</span>First_Flr_SF) <span class="sc">%&gt;%</span> </span>
<span id="cb189-68"><a href="workflowsets.html#cb189-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Bsmt_Cond&quot;</span>)<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span> </span>
<span id="cb189-69"><a href="workflowsets.html#cb189-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;BsmtFin_Type_1&quot;</span>)<span class="sc">:</span>BsmtFin_SF_1) <span class="sc">%&gt;%</span> </span>
<span id="cb189-70"><a href="workflowsets.html#cb189-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;BsmtFin_Type_1&quot;</span>)<span class="sc">:</span>Total_Bsmt_SF) <span class="sc">%&gt;%</span> </span>
<span id="cb189-71"><a href="workflowsets.html#cb189-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Heating_QC&quot;</span>)<span class="sc">:</span>TotRms_AbvGrd) <span class="sc">%&gt;%</span> </span>
<span id="cb189-72"><a href="workflowsets.html#cb189-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Heating_QC&quot;</span>)<span class="sc">:</span>TotalSF) <span class="sc">%&gt;%</span></span>
<span id="cb189-73"><a href="workflowsets.html#cb189-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Heating_QC&quot;</span>)<span class="sc">:</span>Second_Flr_SF) <span class="sc">%&gt;%</span></span>
<span id="cb189-74"><a href="workflowsets.html#cb189-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="sc">~</span> <span class="fu">matches</span>(<span class="st">&quot;Neighborhood&quot;</span>)<span class="sc">:</span><span class="fu">matches</span>(<span class="st">&quot;Condition_1&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb189-75"><a href="workflowsets.html#cb189-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(</span>
<span id="cb189-76"><a href="workflowsets.html#cb189-76" aria-hidden="true" tabindex="-1"></a>    First_Flr_SF, Second_Flr_SF, Year_Remod,</span>
<span id="cb189-77"><a href="workflowsets.html#cb189-77" aria-hidden="true" tabindex="-1"></a>    Bsmt_Full_Bath, Bsmt_Half_Bath, </span>
<span id="cb189-78"><a href="workflowsets.html#cb189-78" aria-hidden="true" tabindex="-1"></a>    Kitchen_AbvGr, BsmtFin_Type_1_Unf, </span>
<span id="cb189-79"><a href="workflowsets.html#cb189-79" aria-hidden="true" tabindex="-1"></a>    Total_Bsmt_SF, Kitchen_AbvGr, Pool_Area, </span>
<span id="cb189-80"><a href="workflowsets.html#cb189-80" aria-hidden="true" tabindex="-1"></a>    Gr_Liv_Area, Porch_SF,</span>
<span id="cb189-81"><a href="workflowsets.html#cb189-81" aria-hidden="true" tabindex="-1"></a>    Sale_Type_Oth, Sale_Type_VWD</span>
<span id="cb189-82"><a href="workflowsets.html#cb189-82" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb189-83"><a href="workflowsets.html#cb189-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-84"><a href="workflowsets.html#cb189-84" aria-hidden="true" tabindex="-1"></a>receta_grande_prep <span class="ot">&lt;-</span> receta_grande <span class="sc">%&gt;%</span> <span class="fu">prep</span>()</span></code></pre></div>
</div>
<div id="múltiples-modelos" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Múltiples modelos<a href="workflowsets.html#múltiples-modelos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Una vez que tenemos suficientes recetas, podemos experimentar con múltiples modelos para poner a prueba. Usaremos los modelos que hemos aprendido a implementar en todo el curso:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="workflowsets.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rules)</span>
<span id="cb190-2"><a href="workflowsets.html#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baguette)</span>
<span id="cb190-3"><a href="workflowsets.html#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tune)</span>
<span id="cb190-4"><a href="workflowsets.html#cb190-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-5"><a href="workflowsets.html#cb190-5" aria-hidden="true" tabindex="-1"></a>elasticnet_model <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(</span>
<span id="cb190-6"><a href="workflowsets.html#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb190-7"><a href="workflowsets.html#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">penalty =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-8"><a href="workflowsets.html#cb190-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mixture =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb190-9"><a href="workflowsets.html#cb190-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>) </span>
<span id="cb190-10"><a href="workflowsets.html#cb190-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-11"><a href="workflowsets.html#cb190-11" aria-hidden="true" tabindex="-1"></a>knn_model <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(</span>
<span id="cb190-12"><a href="workflowsets.html#cb190-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb190-13"><a href="workflowsets.html#cb190-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">neighbors =</span> <span class="fu">tune</span>(<span class="st">&quot;K&quot;</span>),</span>
<span id="cb190-14"><a href="workflowsets.html#cb190-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist_power =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-15"><a href="workflowsets.html#cb190-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight_func =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb190-16"><a href="workflowsets.html#cb190-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kknn&quot;</span>)</span>
<span id="cb190-17"><a href="workflowsets.html#cb190-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-18"><a href="workflowsets.html#cb190-18" aria-hidden="true" tabindex="-1"></a>rforest_model <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>(</span>
<span id="cb190-19"><a href="workflowsets.html#cb190-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb190-20"><a href="workflowsets.html#cb190-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">trees =</span> <span class="dv">1000</span>,</span>
<span id="cb190-21"><a href="workflowsets.html#cb190-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-22"><a href="workflowsets.html#cb190-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb190-23"><a href="workflowsets.html#cb190-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(</span>
<span id="cb190-24"><a href="workflowsets.html#cb190-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ranger&quot;</span>,</span>
<span id="cb190-25"><a href="workflowsets.html#cb190-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">importance =</span> <span class="st">&quot;impurity&quot;</span></span>
<span id="cb190-26"><a href="workflowsets.html#cb190-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb190-27"><a href="workflowsets.html#cb190-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-28"><a href="workflowsets.html#cb190-28" aria-hidden="true" tabindex="-1"></a>svm_rbf_model <span class="ot">&lt;-</span> <span class="fu">svm_rbf</span>(</span>
<span id="cb190-29"><a href="workflowsets.html#cb190-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-30"><a href="workflowsets.html#cb190-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">rbf_sigma =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-31"><a href="workflowsets.html#cb190-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb190-32"><a href="workflowsets.html#cb190-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kernlab&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-33"><a href="workflowsets.html#cb190-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>)</span>
<span id="cb190-34"><a href="workflowsets.html#cb190-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-35"><a href="workflowsets.html#cb190-35" aria-hidden="true" tabindex="-1"></a>xgboost_model <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>(</span>
<span id="cb190-36"><a href="workflowsets.html#cb190-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb190-37"><a href="workflowsets.html#cb190-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">trees =</span> <span class="dv">1000</span>,</span>
<span id="cb190-38"><a href="workflowsets.html#cb190-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_depth =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-39"><a href="workflowsets.html#cb190-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-40"><a href="workflowsets.html#cb190-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss_reduction =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-41"><a href="workflowsets.html#cb190-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_size =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-42"><a href="workflowsets.html#cb190-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="fu">tune</span>(),</span>
<span id="cb190-43"><a href="workflowsets.html#cb190-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">learn_rate =</span> <span class="fu">tune</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb190-44"><a href="workflowsets.html#cb190-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(</span>
<span id="cb190-45"><a href="workflowsets.html#cb190-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;xgboost&quot;</span>,</span>
<span id="cb190-46"><a href="workflowsets.html#cb190-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">importance =</span> <span class="st">&quot;impurity&quot;</span></span>
<span id="cb190-47"><a href="workflowsets.html#cb190-47" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><strong>¿Cómo podemos hacer coincidir estos modelos con las recetas desarrolladas, ajustarlos y luego evaluar su rendimiento de manera eficiente? WORKFLOWSETS ofrece una solución.</strong></p>
</div>
<div id="creación-de-workflowset" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Creación de workflowset<a href="workflowsets.html#creación-de-workflowset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Los conjuntos de flujo de trabajo toman listas nombradas de preprocesadores y especificaciones de modelos y las combinan en un objeto que contiene múltiples flujos de trabajo.</p>
<p>Como primer ejemplo de conjunto de flujo de trabajo, combinemos las recetas creadas en la sección anterior.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="workflowsets.html#cb191-1" aria-hidden="true" tabindex="-1"></a>workflow_set_models <span class="ot">&lt;-</span> <span class="fu">workflow_set</span>(</span>
<span id="cb191-2"><a href="workflowsets.html#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">preproc =</span> <span class="fu">list</span>(</span>
<span id="cb191-3"><a href="workflowsets.html#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">receta_original =</span> receta_original_prep, </span>
<span id="cb191-4"><a href="workflowsets.html#cb191-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">receta_knn =</span> receta_knn_prep,</span>
<span id="cb191-5"><a href="workflowsets.html#cb191-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">receta_grande =</span> receta_grande_prep</span>
<span id="cb191-6"><a href="workflowsets.html#cb191-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb191-7"><a href="workflowsets.html#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">models =</span> <span class="fu">list</span>(</span>
<span id="cb191-8"><a href="workflowsets.html#cb191-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">elasticnet =</span> elasticnet_model,</span>
<span id="cb191-9"><a href="workflowsets.html#cb191-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">knn =</span> knn_model,</span>
<span id="cb191-10"><a href="workflowsets.html#cb191-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">rf =</span> rforest_model,</span>
<span id="cb191-11"><a href="workflowsets.html#cb191-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">svm_rbf =</span> svm_rbf_model,</span>
<span id="cb191-12"><a href="workflowsets.html#cb191-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">boost =</span> xgboost_model</span>
<span id="cb191-13"><a href="workflowsets.html#cb191-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb191-14"><a href="workflowsets.html#cb191-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="ajuste-y-evaluación-de-modelos" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Ajuste y evaluación de modelos<a href="workflowsets.html#ajuste-y-evaluación-de-modelos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Casi todos estos flujos de trabajo contienen parámetros de ajuste. Para evaluar su rendimiento, podemos utilizar las funciones estándar de ajuste o remuestreo (por ejemplo, <code>tune_grid()</code>).</p>
<p>La función <code>workflow_map()</code> aplicará la misma función a todos los flujos de trabajo del conjunto; el valor predeterminado es <code>tune_grid()</code>.</p>
<p>A continuación se declaran los parámetros para cada modelo y el grid:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="workflowsets.html#cb192-1" aria-hidden="true" tabindex="-1"></a>elasticnet_params <span class="ot">&lt;-</span> elasticnet_model <span class="sc">%&gt;%</span></span>
<span id="cb192-2"><a href="workflowsets.html#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">%&gt;%</span></span>
<span id="cb192-3"><a href="workflowsets.html#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(</span>
<span id="cb192-4"><a href="workflowsets.html#cb192-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">penalty =</span> <span class="fu">penalty</span>(</span>
<span id="cb192-5"><a href="workflowsets.html#cb192-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb192-6"><a href="workflowsets.html#cb192-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">trans =</span> <span class="fu">log10_trans</span>()),</span>
<span id="cb192-7"><a href="workflowsets.html#cb192-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mixture =</span> dials<span class="sc">::</span><span class="fu">mixture</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb192-8"><a href="workflowsets.html#cb192-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb192-9"><a href="workflowsets.html#cb192-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-10"><a href="workflowsets.html#cb192-10" aria-hidden="true" tabindex="-1"></a>knn_params <span class="ot">&lt;-</span> knn_model <span class="sc">%&gt;%</span></span>
<span id="cb192-11"><a href="workflowsets.html#cb192-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">%&gt;%</span></span>
<span id="cb192-12"><a href="workflowsets.html#cb192-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(</span>
<span id="cb192-13"><a href="workflowsets.html#cb192-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">K =</span> dials<span class="sc">::</span><span class="fu">neighbors</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">80</span>)),</span>
<span id="cb192-14"><a href="workflowsets.html#cb192-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist_power =</span> <span class="fu">dist_power</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb192-15"><a href="workflowsets.html#cb192-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_func =</span> <span class="fu">weight_func</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;rectangular&quot;</span>, <span class="st">&quot;inv&quot;</span>, <span class="st">&quot;gaussian&quot;</span>, <span class="st">&quot;cos&quot;</span>))</span>
<span id="cb192-16"><a href="workflowsets.html#cb192-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb192-17"><a href="workflowsets.html#cb192-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-18"><a href="workflowsets.html#cb192-18" aria-hidden="true" tabindex="-1"></a>rforest_params <span class="ot">&lt;-</span> rforest_model <span class="sc">%&gt;%</span></span>
<span id="cb192-19"><a href="workflowsets.html#cb192-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">%&gt;%</span></span>
<span id="cb192-20"><a href="workflowsets.html#cb192-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(</span>
<span id="cb192-21"><a href="workflowsets.html#cb192-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry =</span> <span class="fu">mtry</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">150</span>)),</span>
<span id="cb192-22"><a href="workflowsets.html#cb192-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_n =</span> <span class="fu">min_n</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">15</span>))</span>
<span id="cb192-23"><a href="workflowsets.html#cb192-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb192-24"><a href="workflowsets.html#cb192-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-25"><a href="workflowsets.html#cb192-25" aria-hidden="true" tabindex="-1"></a>svm_rbf_params <span class="ot">&lt;-</span> svm_rbf_model <span class="sc">%&gt;%</span></span>
<span id="cb192-26"><a href="workflowsets.html#cb192-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">%&gt;%</span></span>
<span id="cb192-27"><a href="workflowsets.html#cb192-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(</span>
<span id="cb192-28"><a href="workflowsets.html#cb192-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">cost =</span> <span class="fu">cost</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)),</span>
<span id="cb192-29"><a href="workflowsets.html#cb192-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">rbf_sigma =</span> <span class="fu">rbf_sigma</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)),</span>
<span id="cb192-30"><a href="workflowsets.html#cb192-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin =</span> <span class="fu">svm_margin</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb192-31"><a href="workflowsets.html#cb192-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb192-32"><a href="workflowsets.html#cb192-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-33"><a href="workflowsets.html#cb192-33" aria-hidden="true" tabindex="-1"></a>xgboost_params <span class="ot">&lt;-</span> xgboost_model <span class="sc">%&gt;%</span></span>
<span id="cb192-34"><a href="workflowsets.html#cb192-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">%&gt;%</span></span>
<span id="cb192-35"><a href="workflowsets.html#cb192-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(</span>
<span id="cb192-36"><a href="workflowsets.html#cb192-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_n =</span> <span class="fu">min_n</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">15</span>)),</span>
<span id="cb192-37"><a href="workflowsets.html#cb192-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry =</span> <span class="fu">mtry</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">150</span>)),</span>
<span id="cb192-38"><a href="workflowsets.html#cb192-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">tree_depth =</span> <span class="fu">tree_depth</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">50</span>)),</span>
<span id="cb192-39"><a href="workflowsets.html#cb192-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">loss_reduction =</span> <span class="fu">loss_reduction</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="fl">1.5</span>), <span class="at">trans =</span> <span class="fu">log10_trans</span>()),</span>
<span id="cb192-40"><a href="workflowsets.html#cb192-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">learn_rate =</span> <span class="fu">learn_rate</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="fl">0.25</span>), <span class="at">trans =</span> <span class="fu">log10_trans</span>()),</span>
<span id="cb192-41"><a href="workflowsets.html#cb192-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_size =</span> <span class="fu">sample_prop</span>()</span>
<span id="cb192-42"><a href="workflowsets.html#cb192-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb192-43"><a href="workflowsets.html#cb192-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-44"><a href="workflowsets.html#cb192-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Declaración del grid</span></span>
<span id="cb192-45"><a href="workflowsets.html#cb192-45" aria-hidden="true" tabindex="-1"></a>workflow_tunning_set_models <span class="ot">&lt;-</span> workflow_set_models <span class="sc">%&gt;%</span></span>
<span id="cb192-46"><a href="workflowsets.html#cb192-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">option_add</span>(<span class="at">param_info =</span> elasticnet_params, <span class="at">id =</span> <span class="st">&quot;elasticnet&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb192-47"><a href="workflowsets.html#cb192-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">option_add</span>(<span class="at">param_info =</span> knn_params, <span class="at">id =</span> <span class="st">&quot;knn&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-48"><a href="workflowsets.html#cb192-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">option_add</span>(<span class="at">param_info =</span> rforest_params, <span class="at">id =</span> <span class="st">&quot;rf&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-49"><a href="workflowsets.html#cb192-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">option_add</span>(<span class="at">param_info =</span> svm_rbf_params, <span class="at">id =</span> <span class="st">&quot;svm_rbf&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb192-50"><a href="workflowsets.html#cb192-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">option_add</span>(<span class="at">param_info =</span> xgboost_params, <span class="at">id =</span> <span class="st">&quot;xgboost&quot;</span>)</span>
<span id="cb192-51"><a href="workflowsets.html#cb192-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-52"><a href="workflowsets.html#cb192-52" aria-hidden="true" tabindex="-1"></a>workflow_tunning_set_models</span></code></pre></div>
<pre><code>## # A workflow set/tibble: 15 × 4
##    wflow_id                   info             option    result    
##    &lt;chr&gt;                      &lt;list&gt;           &lt;list&gt;    &lt;list&gt;    
##  1 receta_original_elasticnet &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
##  2 receta_original_knn        &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
##  3 receta_original_rf         &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
##  4 receta_original_svm_rbf    &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
##  5 receta_original_boost      &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
##  6 receta_knn_elasticnet      &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
##  7 receta_knn_knn             &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
##  8 receta_knn_rf              &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
##  9 receta_knn_svm_rbf         &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
## 10 receta_knn_boost           &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
## 11 receta_grande_elasticnet   &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
## 12 receta_grande_knn          &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
## 13 receta_grande_rf           &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
## 14 receta_grande_svm_rbf      &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
## 15 receta_grande_boost        &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;</code></pre>
<p>Dado que el preprocesador contiene más de una entrada, la función crea todas las combinaciones de preprocesadores y modelos.</p>
<ul>
<li><p><strong>info:</strong> Contiene un <em>tibble</em> con algunos identificadores y el objeto de flujo de trabajo.</p></li>
<li><p><strong>option:</strong> Es un marcador de posición para cualquier argumento que se utilice cuando evaluamos el flujo de trabajo.</p></li>
<li><p><strong>result:</strong> Es un marcador de posición para la salida de las funciones de ajuste o remuestreo.</p></li>
</ul>
<p>Para este ejemplo, la búsqueda del <em>grid</em> se aplica al flujo de trabajo.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="workflowsets.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb194-2"><a href="workflowsets.html#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="workflowsets.html#cb194-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb194-4"><a href="workflowsets.html#cb194-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb194-5"><a href="workflowsets.html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb194-6"><a href="workflowsets.html#cb194-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-7"><a href="workflowsets.html#cb194-7" aria-hidden="true" tabindex="-1"></a>grid_ctrl <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(</span>
<span id="cb194-8"><a href="workflowsets.html#cb194-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_pred =</span> <span class="cn">TRUE</span>,</span>
<span id="cb194-9"><a href="workflowsets.html#cb194-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_workflow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb194-10"><a href="workflowsets.html#cb194-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel_over =</span> <span class="st">&quot;everything&quot;</span></span>
<span id="cb194-11"><a href="workflowsets.html#cb194-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb194-12"><a href="workflowsets.html#cb194-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-13"><a href="workflowsets.html#cb194-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">536</span>)</span>
<span id="cb194-14"><a href="workflowsets.html#cb194-14" aria-hidden="true" tabindex="-1"></a>tunning_models_result <span class="ot">&lt;-</span> workflow_tunning_set_models <span class="sc">%&gt;%</span></span>
<span id="cb194-15"><a href="workflowsets.html#cb194-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow_map</span>(</span>
<span id="cb194-16"><a href="workflowsets.html#cb194-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> <span class="st">&quot;tune_grid&quot;</span>,</span>
<span id="cb194-17"><a href="workflowsets.html#cb194-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">20220603</span>,</span>
<span id="cb194-18"><a href="workflowsets.html#cb194-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> ames_folds,</span>
<span id="cb194-19"><a href="workflowsets.html#cb194-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="dv">100</span>,</span>
<span id="cb194-20"><a href="workflowsets.html#cb194-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span>  <span class="fu">metric_set</span>(rmse, mae, mape, rsq),</span>
<span id="cb194-21"><a href="workflowsets.html#cb194-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> grid_ctrl,</span>
<span id="cb194-22"><a href="workflowsets.html#cb194-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb194-23"><a href="workflowsets.html#cb194-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb194-24"><a href="workflowsets.html#cb194-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-25"><a href="workflowsets.html#cb194-25" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb194-26"><a href="workflowsets.html#cb194-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-27"><a href="workflowsets.html#cb194-27" aria-hidden="true" tabindex="-1"></a>tunning_models_result <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/ensemble_model.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="workflowsets.html#cb195-1" aria-hidden="true" tabindex="-1"></a>tunning_models_result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;models/ensemble_model.rds&quot;</span>)</span>
<span id="cb195-2"><a href="workflowsets.html#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="workflowsets.html#cb195-3" aria-hidden="true" tabindex="-1"></a>tunning_models_result <span class="sc">%&gt;%</span></span>
<span id="cb195-4"><a href="workflowsets.html#cb195-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rank_results</span>(<span class="at">select_best =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb195-5"><a href="workflowsets.html#cb195-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.config, n, preprocessor, std_err)) <span class="sc">%&gt;%</span></span>
<span id="cb195-6"><a href="workflowsets.html#cb195-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .metric, <span class="at">values_from =</span> mean) </span></code></pre></div>
<pre><code>## # A tibble: 15 × 7
##    wflow_id                   model             rank    mae  mape   rmse   rsq
##    &lt;chr&gt;                      &lt;chr&gt;            &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 receta_knn_boost           boost_tree           1 16614.  10.4 25425. 0.900
##  2 receta_knn_rf              rand_forest          2 17766.  11.1 28489. 0.877
##  3 receta_knn_svm_rbf         svm_rbf              3 17985.  11.3 29103. 0.865
##  4 receta_knn_knn             nearest_neighbor     4 19471.  11.6 30465. 0.861
##  5 receta_original_boost      boost_tree           5 20019.  12.2 30569. 0.856
##  6 receta_grande_boost        boost_tree           6 20019.  12.2 30569. 0.856
##  7 receta_original_rf         rand_forest          7 21058.  12.9 33599. 0.828
##  8 receta_grande_rf           rand_forest          8 21058.  12.9 33599. 0.828
##  9 receta_grande_knn          nearest_neighbor     9 22561.  13.0 35353. 0.817
## 10 receta_original_knn        nearest_neighbor    10 22561.  13.0 35353. 0.817
## 11 receta_grande_svm_rbf      svm_rbf             11 22839.  13.8 35431. 0.807
## 12 receta_original_svm_rbf    svm_rbf             12 22839.  13.8 35431. 0.807
## 13 receta_knn_elasticnet      linear_reg          13 24196.  14.7 39880. 0.756
## 14 receta_grande_elasticnet   linear_reg          14 30129.  18.4 44124. 0.694
## 15 receta_original_elasticnet linear_reg          15 30129.  18.4 44124. 0.694</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="workflowsets.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(</span>
<span id="cb197-2"><a href="workflowsets.html#cb197-2" aria-hidden="true" tabindex="-1"></a>  tunning_models_result,</span>
<span id="cb197-3"><a href="workflowsets.html#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank_metric =</span> <span class="st">&quot;rsq&quot;</span>,</span>
<span id="cb197-4"><a href="workflowsets.html#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>,   </span>
<span id="cb197-5"><a href="workflowsets.html#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">select_best =</span> F) <span class="sc">+</span>   </span>
<span id="cb197-6"><a href="workflowsets.html#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb197-7"><a href="workflowsets.html#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model Comparisson&quot;</span>)</span></code></pre></div>
<p><img src="amt22_03intro2mls2_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="workflowsets.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(</span>
<span id="cb198-2"><a href="workflowsets.html#cb198-2" aria-hidden="true" tabindex="-1"></a>  tunning_models_result,</span>
<span id="cb198-3"><a href="workflowsets.html#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank_metric =</span> <span class="st">&quot;rsq&quot;</span>,</span>
<span id="cb198-4"><a href="workflowsets.html#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>,   </span>
<span id="cb198-5"><a href="workflowsets.html#cb198-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">select_best =</span> T) <span class="sc">+</span></span>
<span id="cb198-6"><a href="workflowsets.html#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">-</span> <span class="fl">0.10</span> , <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb198-7"><a href="workflowsets.html#cb198-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb198-8"><a href="workflowsets.html#cb198-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model Comparisson&quot;</span>)</span></code></pre></div>
<p><img src="amt22_03intro2mls2_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
</div>
<div id="extracción-de-modelos" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Extracción de modelos<a href="workflowsets.html#extracción-de-modelos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Una vez que hemos realizado una exploración sobre el desempeño de todas las combinaciones de preprocesamientos con modelos, es posible tomar varios caminos hacia adelante. Algunas de las opciones más comunes son:</p>
<ul>
<li><p>Realizar múltiples iteraciones de modificaciones a las recetas para extraer lo mejor de cada una.</p></li>
<li><p>Realizar mejoras a los hiperparámetros.</p></li>
<li><p>Eliminar modelos y/o recetas que no tuvieron buen desempeño.</p></li>
<li><p>Crear un modelo a partir de la combinación de los modelos más competentes.</p></li>
</ul>
<p>Para empezar, se realiza una exploración del resultado del desempeño de los mejores modelos y los hiperparámetros usado en cada caso.</p>
<p><strong>Resultados de XGBoost</strong></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="workflowsets.html#cb199-1" aria-hidden="true" tabindex="-1"></a>tunning_models_result <span class="sc">%&gt;%</span> </span>
<span id="cb199-2"><a href="workflowsets.html#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(<span class="st">&quot;receta_knn_boost&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-3"><a href="workflowsets.html#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>)</span></code></pre></div>
<p><img src="amt22_03intro2mls2_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="workflowsets.html#cb200-1" aria-hidden="true" tabindex="-1"></a>tunning_models_result <span class="sc">%&gt;%</span> </span>
<span id="cb200-2"><a href="workflowsets.html#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(<span class="st">&quot;receta_knn_boost&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb200-3"><a href="workflowsets.html#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_best</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb200-4"><a href="workflowsets.html#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.estimator, .metric, .config, n))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 8
##     mtry min_n tree_depth learn_rate loss_reduction sample_size  mean std_err
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;      &lt;dbl&gt;          &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1     2     4          8    0.0318    0.0000000180       0.601 0.900 0.00487
##  2     8     7          6    0.0661    0.0692             0.723 0.897 0.00537
##  3     4     7          7    0.0871    5.50               0.892 0.896 0.00493
##  4    25     4         11    0.0381    7.61               0.425 0.894 0.00596
##  5     5    11          5    0.0263    0.0198             0.444 0.893 0.00581
##  6    21     5         13    0.0120    0.00108            0.415 0.891 0.00724
##  7    12     7         15    0.00611   3.24               0.656 0.891 0.00730
##  8    29     3          9    0.0375    0.00000107         0.820 0.891 0.00419
##  9    12    13         14    0.0158   25.3                0.778 0.891 0.00825
## 10    15    19          7    0.0161   17.5                0.692 0.891 0.00767</code></pre>
<p><strong>Resultados de Ranfom Forest</strong></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="workflowsets.html#cb202-1" aria-hidden="true" tabindex="-1"></a>tunning_models_result <span class="sc">%&gt;%</span> </span>
<span id="cb202-2"><a href="workflowsets.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(<span class="st">&quot;receta_knn_rf&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb202-3"><a href="workflowsets.html#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<p><img src="amt22_03intro2mls2_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="workflowsets.html#cb203-1" aria-hidden="true" tabindex="-1"></a>tunning_models_result <span class="sc">%&gt;%</span> </span>
<span id="cb203-2"><a href="workflowsets.html#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(<span class="st">&quot;receta_knn_rf&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-3"><a href="workflowsets.html#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_best</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">metric =</span> <span class="st">&quot;rmse&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb203-4"><a href="workflowsets.html#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.estimator, .metric, .config, n))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
##     mtry min_n   mean std_err
##    &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1     9     7 28489.   1010.
##  2    13     5 28491.    883.
##  3    10     4 28524.    970.
##  4    18     5 28604.    882.
##  5    12     8 28613.    947.
##  6    11     9 28620.    939.
##  7    13     6 28628.    928.
##  8     5     7 28689.   1052.
##  9    16     6 28699.    920.
## 10    16     8 28737.    912.</code></pre>
<div id="selección-de-modelo" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Selección de modelo<a href="workflowsets.html#selección-de-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Habiendo determinado los hiperparámetros adecuados para la configuración del modelo, procedemos a seleccionar la configuración adecuada para nosotros. Estos pasos son los mismos que corresponden a la selección del modelo con un único workflow.</p>
<p><strong>Mejore modelo XGBoost</strong></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="workflowsets.html#cb205-1" aria-hidden="true" tabindex="-1"></a>best_xgb_model <span class="ot">&lt;-</span> tunning_models_result <span class="sc">%&gt;%</span></span>
<span id="cb205-2"><a href="workflowsets.html#cb205-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">extract_workflow_set_result</span>(<span class="st">&quot;receta_knn_boost&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb205-3"><a href="workflowsets.html#cb205-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb205-4"><a href="workflowsets.html#cb205-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-5"><a href="workflowsets.html#cb205-5" aria-hidden="true" tabindex="-1"></a>best_xgb_model <span class="sc">%&gt;%</span> </span>
<span id="cb205-6"><a href="workflowsets.html#cb205-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.character) <span class="sc">%&gt;%</span> </span>
<span id="cb205-7"><a href="workflowsets.html#cb205-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 × 2
##   metric         value                 
##   &lt;chr&gt;          &lt;chr&gt;                 
## 1 mtry           2                     
## 2 min_n          4                     
## 3 tree_depth     8                     
## 4 learn_rate     0.0318069757974226    
## 5 loss_reduction 1.8022375282862e-08   
## 6 sample_size    0.60145520768594      
## 7 .config        Preprocessor1_Model058</code></pre>
<p><strong>Mejore modelo XGBoost a menos de una desviación estandar</strong></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="workflowsets.html#cb207-1" aria-hidden="true" tabindex="-1"></a>best_regularized_xgb_model_1se <span class="ot">&lt;-</span> tunning_models_result <span class="sc">%&gt;%</span></span>
<span id="cb207-2"><a href="workflowsets.html#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(<span class="st">&quot;receta_knn_boost&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb207-3"><a href="workflowsets.html#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;rsq&quot;</span>)</span>
<span id="cb207-4"><a href="workflowsets.html#cb207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-5"><a href="workflowsets.html#cb207-5" aria-hidden="true" tabindex="-1"></a>best_regularized_xgb_model_1se <span class="sc">%&gt;%</span> </span>
<span id="cb207-6"><a href="workflowsets.html#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.character) <span class="sc">%&gt;%</span> </span>
<span id="cb207-7"><a href="workflowsets.html#cb207-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 14 × 2
##    metric         value                 
##    &lt;chr&gt;          &lt;chr&gt;                 
##  1 mtry           8                     
##  2 min_n          7                     
##  3 tree_depth     6                     
##  4 learn_rate     0.0660688823690034    
##  5 loss_reduction 0.0691664318630444    
##  6 sample_size    0.723484068220947     
##  7 .metric        rsq                   
##  8 .estimator     standard              
##  9 mean           0.896674936544582     
## 10 n              10                    
## 11 std_err        0.00536531804472105   
## 12 .config        Preprocessor1_Model035
## 13 .best          0.900303988301004     
## 14 .bound         0.895438860790247</code></pre>
<p><strong>Mejore modelo XGBoost a menos de un porcentaje fijo</strong></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="workflowsets.html#cb209-1" aria-hidden="true" tabindex="-1"></a>best_regularized_xgb_model_pct <span class="ot">&lt;-</span> tunning_models_result <span class="sc">%&gt;%</span></span>
<span id="cb209-2"><a href="workflowsets.html#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow_set_result</span>(<span class="st">&quot;receta_knn_boost&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb209-3"><a href="workflowsets.html#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_by_pct_loss</span>(<span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>, <span class="st">&quot;rsq&quot;</span>, <span class="at">limit =</span> <span class="dv">10</span>)</span>
<span id="cb209-4"><a href="workflowsets.html#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="workflowsets.html#cb209-5" aria-hidden="true" tabindex="-1"></a>best_regularized_xgb_model_pct <span class="sc">%&gt;%</span> </span>
<span id="cb209-6"><a href="workflowsets.html#cb209-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.character) <span class="sc">%&gt;%</span> </span>
<span id="cb209-7"><a href="workflowsets.html#cb209-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 14 × 2
##    metric         value                 
##    &lt;chr&gt;          &lt;chr&gt;                 
##  1 mtry           13                    
##  2 min_n          36                    
##  3 tree_depth     2                     
##  4 learn_rate     0.00313559984945049   
##  5 loss_reduction 0.190594567355415     
##  6 sample_size    0.36900916616735      
##  7 .metric        rsq                   
##  8 .estimator     standard              
##  9 mean           0.824569900806526     
## 10 n              10                    
## 11 std_err        0.00788602755362551   
## 12 .config        Preprocessor1_Model030
## 13 .best          0.900303988301004     
## 14 .loss          8.41205731381887</code></pre>
<p><strong>Ajuste del modelo seleccionado</strong></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="workflowsets.html#cb211-1" aria-hidden="true" tabindex="-1"></a>final_regularized_xgb_model <span class="ot">&lt;-</span> tunning_models_result <span class="sc">%&gt;%</span></span>
<span id="cb211-2"><a href="workflowsets.html#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_workflow</span>(<span class="st">&quot;receta_knn_boost&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb211-3"><a href="workflowsets.html#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(best_regularized_xgb_model_1se) <span class="sc">%&gt;%</span></span>
<span id="cb211-4"><a href="workflowsets.html#cb211-4" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">fit</span>(<span class="at">data =</span> ames_train)</span></code></pre></div>
<pre><code>## [10:34:20] WARNING: amalgamation/../src/learner.cc:627: 
## Parameters: { &quot;importance&quot; } might not be used.
## 
##   This could be a false alarm, with some parameters getting used by language bindings but
##   then being mistakenly passed down to XGBoost core, or some parameter actually being used
##   but getting flagged wrongly here. Please open an issue if you find any such cases.</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="workflowsets.html#cb213-1" aria-hidden="true" tabindex="-1"></a>final_regularized_xgb_model</span></code></pre></div>
<pre><code>## ══ Workflow [trained] ══════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: boost_tree()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 23 Recipe Steps
## 
## • step_unknown()
## • step_unknown()
## • step_unknown()
## • step_unknown()
## • step_unknown()
## • step_unknown()
## • step_unknown()
## • step_unknown()
## • step_unknown()
## • step_unknown()
## • ...
## • and 13 more steps.
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## ##### xgb.Booster
## raw: 2.5 Mb 
## call:
##   xgboost::xgb.train(params = list(eta = 0.0660688823690034, max_depth = 6L, 
##     gamma = 0.0691664318630444, colsample_bytree = 1, colsample_bynode = 0.258064516129032, 
##     min_child_weight = 7L, subsample = 0.723484068220947, objective = &quot;reg:squarederror&quot;), 
##     data = x$data, nrounds = 1000, watchlist = x$watchlist, verbose = 0, 
##     importance = &quot;impurity&quot;, nthread = 1)
## params (as set within xgb.train):
##   eta = &quot;0.0660688823690034&quot;, max_depth = &quot;6&quot;, gamma = &quot;0.0691664318630444&quot;, colsample_bytree = &quot;1&quot;, colsample_bynode = &quot;0.258064516129032&quot;, min_child_weight = &quot;7&quot;, subsample = &quot;0.723484068220947&quot;, objective = &quot;reg:squarederror&quot;, importance = &quot;impurity&quot;, nthread = &quot;1&quot;, validate_parameters = &quot;TRUE&quot;
## xgb.attributes:
##   niter
## callbacks:
##   cb.evaluation.log()
## # of features: 31 
## niter: 1000
## nfeatures : 31 
## evaluation_log:
##     iter training_rmse
##        1    185201.353
##        2    173702.070
## ---                   
##      999      1852.079
##     1000      1847.191</code></pre>
</div>
<div id="método-de-carrera" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Método de carrera<a href="workflowsets.html#método-de-carrera" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un problema con la búsqueda del <em>grid</em> es que <strong>todos los modelos deben ajustarse</strong> en todos los remuestreos antes de que se puedan evaluar los parámetros de ajuste.</p>
<p>En <em>machine learning</em>, el conjunto de técnicas que son llamadas <strong>métodos de carreras</strong>
evalúa todos los modelos en un subconjunto inicial de remuestreo. En función de sus métricas de rendimiento actuales, algunos conjuntos de parámetros no se consideran en remuestreos posteriores.</p>
<p>Dado un <strong>workflow</strong>, podemos usar la función <code>workflow_map()</code> para un enfoque de carreras. El paquete <em>finetune</em> contiene funciones para el método de carreras. Calcula un conjunto de métricas de rendimiento (por ejemplo, precisión o RMSE) para un conjunto predefinido de parámetros de ajuste que corresponden a un modelo o receta a través de una o más muestras de los datos.</p>
<div id="optimización-anova" class="section level4 hasAnchor" number="5.5.2.1">
<h4><span class="header-section-number">5.5.2.1</span> Optimización ANOVA<a href="workflowsets.html#optimización-anova" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Realiza un modelo de análisis de varianza (ANOVA) para probar la significación estadística de las diferentes configuraciones del modelo. Después de evaluar un número inicial de remuestreos, el proceso elimina las combinaciones de parámetros de ajuste que probablemente no sean los mejores resultados usando medidas repetidas de un modelo ANOVA. La función implementada es <code>tune_race_anova</code></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="workflowsets.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finetune)</span>
<span id="cb215-2"><a href="workflowsets.html#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="workflowsets.html#cb215-3" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb215-4"><a href="workflowsets.html#cb215-4" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb215-5"><a href="workflowsets.html#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb215-6"><a href="workflowsets.html#cb215-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-7"><a href="workflowsets.html#cb215-7" aria-hidden="true" tabindex="-1"></a>race_ctrl <span class="ot">&lt;-</span> <span class="fu">control_race</span>(</span>
<span id="cb215-8"><a href="workflowsets.html#cb215-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pred =</span> <span class="cn">TRUE</span>,</span>
<span id="cb215-9"><a href="workflowsets.html#cb215-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_over =</span> <span class="st">&quot;everything&quot;</span>,</span>
<span id="cb215-10"><a href="workflowsets.html#cb215-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_workflow =</span> <span class="cn">TRUE</span></span>
<span id="cb215-11"><a href="workflowsets.html#cb215-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb215-12"><a href="workflowsets.html#cb215-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-13"><a href="workflowsets.html#cb215-13" aria-hidden="true" tabindex="-1"></a>tunning_race_anova_results <span class="ot">&lt;-</span> workflow_tunning_set_models <span class="sc">%&gt;%</span></span>
<span id="cb215-14"><a href="workflowsets.html#cb215-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow_map</span>(</span>
<span id="cb215-15"><a href="workflowsets.html#cb215-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;tune_race_anova&quot;</span>,</span>
<span id="cb215-16"><a href="workflowsets.html#cb215-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">1503</span>,</span>
<span id="cb215-17"><a href="workflowsets.html#cb215-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> ames_folds,</span>
<span id="cb215-18"><a href="workflowsets.html#cb215-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="dv">100</span>,</span>
<span id="cb215-19"><a href="workflowsets.html#cb215-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span>  <span class="fu">metric_set</span>(rmse, mae, mape, rsq),</span>
<span id="cb215-20"><a href="workflowsets.html#cb215-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> race_ctrl,</span>
<span id="cb215-21"><a href="workflowsets.html#cb215-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb215-22"><a href="workflowsets.html#cb215-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb215-23"><a href="workflowsets.html#cb215-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-24"><a href="workflowsets.html#cb215-24" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb215-25"><a href="workflowsets.html#cb215-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-26"><a href="workflowsets.html#cb215-26" aria-hidden="true" tabindex="-1"></a>tunning_race_anova_results <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/race_anova_results.rds&quot;</span>)</span></code></pre></div>
<p>Las mismas funciones útiles están disponibles para que este objeto interrogue los resultados y, de hecho, el método básico <code>autoplot()</code> produce tendencias similares:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="workflowsets.html#cb216-1" aria-hidden="true" tabindex="-1"></a>tunning_race_anova_results <span class="sc">%&gt;%</span></span>
<span id="cb216-2"><a href="workflowsets.html#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rank_results</span>(<span class="at">select_best =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb216-3"><a href="workflowsets.html#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.config, n, preprocessor, std_err)) <span class="sc">%&gt;%</span></span>
<span id="cb216-4"><a href="workflowsets.html#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .metric, <span class="at">values_from =</span> mean)</span></code></pre></div>
<pre><code>## # A tibble: 15 × 7
##    wflow_id                   model             rank    mae  mape   rmse   rsq
##    &lt;chr&gt;                      &lt;chr&gt;            &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 receta_knn_boost           boost_tree           1 17446.  10.9 26661. 0.890
##  2 receta_knn_rf              rand_forest          2 17717.  11.1 28540. 0.874
##  3 receta_knn_knn             nearest_neighbor     3 19542.  11.5 30991. 0.858
##  4 receta_original_boost      boost_tree           4 21019.  12.8 32223. 0.839
##  5 receta_grande_boost        boost_tree           5 21019.  12.8 32223. 0.839
##  6 receta_original_rf         rand_forest          6 21117.  12.9 33686. 0.826
##  7 receta_grande_rf           rand_forest          7 21117.  12.9 33686. 0.826
##  8 receta_knn_svm_rbf         svm_rbf              8 20491.  12.5 34700. 0.815
##  9 receta_grande_knn          nearest_neighbor     9 22582.  13.0 35541. 0.816
## 10 receta_original_knn        nearest_neighbor    10 22582.  13.0 35541. 0.816
## 11 receta_grande_svm_rbf      svm_rbf             11 24433.  14.7 38699. 0.776
## 12 receta_original_svm_rbf    svm_rbf             12 24433.  14.7 38699. 0.776
## 13 receta_knn_elasticnet      linear_reg          13 24196.  14.7 39883. 0.756
## 14 receta_grande_elasticnet   linear_reg          14 30128.  18.4 44127. 0.694
## 15 receta_original_elasticnet linear_reg          15 30128.  18.4 44127. 0.694</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="workflowsets.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(</span>
<span id="cb218-2"><a href="workflowsets.html#cb218-2" aria-hidden="true" tabindex="-1"></a>  tunning_race_anova_results,</span>
<span id="cb218-3"><a href="workflowsets.html#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank_metric =</span> <span class="st">&quot;rsq&quot;</span>,</span>
<span id="cb218-4"><a href="workflowsets.html#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>,</span>
<span id="cb218-5"><a href="workflowsets.html#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb218-6"><a href="workflowsets.html#cb218-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">-</span> <span class="fl">0.10</span> , <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb218-7"><a href="workflowsets.html#cb218-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="amt22_03intro2mls2_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
</div>
<div id="optimización-logística" class="section level4 hasAnchor" number="5.5.2.2">
<h4><span class="header-section-number">5.5.2.2</span> Optimización logística<a href="workflowsets.html#optimización-logística" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Después de evaluar un número inicial de remuestreos, el proceso elimina las combinaciones de parámetros de ajuste que probablemente no sean los mejores resultados usando un modelo estadístico. Para cada combinación por pares de parámetros de ajuste, se calculan las estadísticas de ganancia/pérdida y se usa un modelo de regresión logística para medir la probabilidad de que cada combinación gane en general. Esto se logra mediante la función <code>tune_race_win_loss</code></p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="workflowsets.html#cb219-1" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb219-2"><a href="workflowsets.html#cb219-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb219-3"><a href="workflowsets.html#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb219-4"><a href="workflowsets.html#cb219-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-5"><a href="workflowsets.html#cb219-5" aria-hidden="true" tabindex="-1"></a>race_ctrl <span class="ot">&lt;-</span> <span class="fu">control_race</span>(</span>
<span id="cb219-6"><a href="workflowsets.html#cb219-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pred =</span> <span class="cn">TRUE</span>,</span>
<span id="cb219-7"><a href="workflowsets.html#cb219-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_over =</span> <span class="st">&quot;everything&quot;</span>,</span>
<span id="cb219-8"><a href="workflowsets.html#cb219-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_workflow =</span> <span class="cn">TRUE</span></span>
<span id="cb219-9"><a href="workflowsets.html#cb219-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb219-10"><a href="workflowsets.html#cb219-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-11"><a href="workflowsets.html#cb219-11" aria-hidden="true" tabindex="-1"></a>tunning_race_win_loss_results <span class="ot">&lt;-</span> workflow_tunning_set_models <span class="sc">%&gt;%</span></span>
<span id="cb219-12"><a href="workflowsets.html#cb219-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow_map</span>(</span>
<span id="cb219-13"><a href="workflowsets.html#cb219-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;tune_race_win_loss&quot;</span>,</span>
<span id="cb219-14"><a href="workflowsets.html#cb219-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">1503</span>,</span>
<span id="cb219-15"><a href="workflowsets.html#cb219-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> ames_folds,</span>
<span id="cb219-16"><a href="workflowsets.html#cb219-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="dv">20</span>,</span>
<span id="cb219-17"><a href="workflowsets.html#cb219-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span>  <span class="fu">metric_set</span>(rmse, mae, mape, rsq),</span>
<span id="cb219-18"><a href="workflowsets.html#cb219-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> race_ctrl,</span>
<span id="cb219-19"><a href="workflowsets.html#cb219-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb219-20"><a href="workflowsets.html#cb219-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb219-21"><a href="workflowsets.html#cb219-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-22"><a href="workflowsets.html#cb219-22" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb219-23"><a href="workflowsets.html#cb219-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-24"><a href="workflowsets.html#cb219-24" aria-hidden="true" tabindex="-1"></a>tunning_race_win_loss_results <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/race_win_loss_results.rds&quot;</span>)</span></code></pre></div>
<p>Las mismas funciones útiles están disponibles para que este objeto interrogue los resultados y, de hecho, el método básico <code>autoplot()</code> produce tendencias similares:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="workflowsets.html#cb220-1" aria-hidden="true" tabindex="-1"></a>tunning_race_win_loss_results <span class="sc">%&gt;%</span></span>
<span id="cb220-2"><a href="workflowsets.html#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rank_results</span>(<span class="at">select_best =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb220-3"><a href="workflowsets.html#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.config, n, preprocessor, std_err)) <span class="sc">%&gt;%</span></span>
<span id="cb220-4"><a href="workflowsets.html#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .metric, <span class="at">values_from =</span> mean)</span></code></pre></div>
<pre><code>## # A tibble: 15 × 7
##    wflow_id                   model             rank    mae  mape   rmse   rsq
##    &lt;chr&gt;                      &lt;chr&gt;            &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 receta_knn_boost           boost_tree           1 17429.  10.9 26616. 0.890
##  2 receta_knn_rf              rand_forest          2 17723.  11.1 28467. 0.876
##  3 receta_knn_knn             nearest_neighbor     3 19542.  11.5 30991. 0.858
##  4 receta_original_boost      boost_tree           4 20802.  12.7 31414. 0.846
##  5 receta_grande_boost        boost_tree           5 20802.  12.7 31414. 0.846
##  6 receta_original_rf         rand_forest          6 21117.  12.9 33693. 0.826
##  7 receta_grande_rf           rand_forest          7 21117.  12.9 33693. 0.826
##  8 receta_knn_svm_rbf         svm_rbf              8 20491.  12.5 34700. 0.815
##  9 receta_grande_knn          nearest_neighbor     9 22582.  13.0 35541. 0.816
## 10 receta_original_knn        nearest_neighbor    10 22582.  13.0 35541. 0.816
## 11 receta_grande_svm_rbf      svm_rbf             11 24433.  14.7 38699. 0.776
## 12 receta_original_svm_rbf    svm_rbf             12 24433.  14.7 38699. 0.776
## 13 receta_knn_elasticnet      linear_reg          13 24196.  14.7 39883. 0.756
## 14 receta_grande_elasticnet   linear_reg          14 30128.  18.4 44127. 0.694
## 15 receta_original_elasticnet linear_reg          15 30128.  18.4 44127. 0.694</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="workflowsets.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(</span>
<span id="cb222-2"><a href="workflowsets.html#cb222-2" aria-hidden="true" tabindex="-1"></a>  tunning_race_win_loss_results,</span>
<span id="cb222-3"><a href="workflowsets.html#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank_metric =</span> <span class="st">&quot;rsq&quot;</span>,</span>
<span id="cb222-4"><a href="workflowsets.html#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>,</span>
<span id="cb222-5"><a href="workflowsets.html#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb222-6"><a href="workflowsets.html#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">-</span> <span class="fl">0.10</span> , <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb222-7"><a href="workflowsets.html#cb222-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="amt22_03intro2mls2_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
</div>
<div id="optimización-bayesiana" class="section level4 hasAnchor" number="5.5.2.3">
<h4><span class="header-section-number">5.5.2.3</span> Optimización bayesiana<a href="workflowsets.html#optimización-bayesiana" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La función <code>tune_bayes</code> usa modelos para crear nuevas combinaciones de hiperparámetros que sean candidatos de tunning basado en resultados previos.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="workflowsets.html#cb223-1" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb223-2"><a href="workflowsets.html#cb223-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb223-3"><a href="workflowsets.html#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb223-4"><a href="workflowsets.html#cb223-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-5"><a href="workflowsets.html#cb223-5" aria-hidden="true" tabindex="-1"></a>race_ctrl <span class="ot">&lt;-</span> <span class="fu">control_bayes</span>(</span>
<span id="cb223-6"><a href="workflowsets.html#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb223-7"><a href="workflowsets.html#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pred =</span> <span class="cn">TRUE</span>,</span>
<span id="cb223-8"><a href="workflowsets.html#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_over =</span> <span class="st">&quot;everything&quot;</span>,</span>
<span id="cb223-9"><a href="workflowsets.html#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_workflow =</span> <span class="cn">TRUE</span></span>
<span id="cb223-10"><a href="workflowsets.html#cb223-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb223-11"><a href="workflowsets.html#cb223-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-12"><a href="workflowsets.html#cb223-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20220603</span>)</span>
<span id="cb223-13"><a href="workflowsets.html#cb223-13" aria-hidden="true" tabindex="-1"></a>tunning_race_bayes_results <span class="ot">&lt;-</span> workflow_tunning_set_models <span class="sc">%&gt;%</span></span>
<span id="cb223-14"><a href="workflowsets.html#cb223-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow_map</span>(</span>
<span id="cb223-15"><a href="workflowsets.html#cb223-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;tune_bayes&quot;</span>,</span>
<span id="cb223-16"><a href="workflowsets.html#cb223-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">1503</span>,</span>
<span id="cb223-17"><a href="workflowsets.html#cb223-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> ames_folds,</span>
<span id="cb223-18"><a href="workflowsets.html#cb223-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">100</span>,</span>
<span id="cb223-19"><a href="workflowsets.html#cb223-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span>  <span class="fu">metric_set</span>(rmse, mae, mape, rsq),</span>
<span id="cb223-20"><a href="workflowsets.html#cb223-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> race_ctrl,</span>
<span id="cb223-21"><a href="workflowsets.html#cb223-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb223-22"><a href="workflowsets.html#cb223-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb223-23"><a href="workflowsets.html#cb223-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-24"><a href="workflowsets.html#cb223-24" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb223-25"><a href="workflowsets.html#cb223-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-26"><a href="workflowsets.html#cb223-26" aria-hidden="true" tabindex="-1"></a>tunning_race_bayes_results <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/race_bayes_results.rds&quot;</span>)</span></code></pre></div>
<p>Las mismas funciones útiles están disponibles para que este objeto interrogue los resultados y, de hecho, el método básico <code>autoplot()</code> produce tendencias similares:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="workflowsets.html#cb224-1" aria-hidden="true" tabindex="-1"></a>tunning_race_bayes_results</span></code></pre></div>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="workflowsets.html#cb225-1" aria-hidden="true" tabindex="-1"></a>tunning_race_bayes_results<span class="sc">$</span>result</span></code></pre></div>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="workflowsets.html#cb226-1" aria-hidden="true" tabindex="-1"></a>tunning_race_bayes_results <span class="sc">%&gt;%</span></span>
<span id="cb226-2"><a href="workflowsets.html#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rank_results</span>(<span class="at">select_best =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb226-3"><a href="workflowsets.html#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.config, n, preprocessor, std_err)) <span class="sc">%&gt;%</span></span>
<span id="cb226-4"><a href="workflowsets.html#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .metric, <span class="at">values_from =</span> mean)</span></code></pre></div>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="workflowsets.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(</span>
<span id="cb227-2"><a href="workflowsets.html#cb227-2" aria-hidden="true" tabindex="-1"></a>  tunning_race_bayes_results,</span>
<span id="cb227-3"><a href="workflowsets.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank_metric =</span> <span class="st">&quot;rsq&quot;</span>,</span>
<span id="cb227-4"><a href="workflowsets.html#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">&quot;rsq&quot;</span>,</span>
<span id="cb227-5"><a href="workflowsets.html#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">select_best =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb227-6"><a href="workflowsets.html#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean <span class="sc">-</span> <span class="fl">0.10</span> , <span class="at">label =</span> wflow_id), <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb227-7"><a href="workflowsets.html#cb227-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="workflowsets.html#cb228-1" aria-hidden="true" tabindex="-1"></a>UseCores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb228-2"><a href="workflowsets.html#cb228-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(UseCores)</span>
<span id="cb228-3"><a href="workflowsets.html#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb228-4"><a href="workflowsets.html#cb228-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-5"><a href="workflowsets.html#cb228-5" aria-hidden="true" tabindex="-1"></a>race_ctrl <span class="ot">&lt;-</span> <span class="fu">control_sim_anneal</span>(</span>
<span id="cb228-6"><a href="workflowsets.html#cb228-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb228-7"><a href="workflowsets.html#cb228-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">no_improve =</span> 10L,</span>
<span id="cb228-8"><a href="workflowsets.html#cb228-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">restart =</span> 10L,</span>
<span id="cb228-9"><a href="workflowsets.html#cb228-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">radius =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.20</span>)</span>
<span id="cb228-10"><a href="workflowsets.html#cb228-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb228-11"><a href="workflowsets.html#cb228-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-12"><a href="workflowsets.html#cb228-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20220603</span>)</span>
<span id="cb228-13"><a href="workflowsets.html#cb228-13" aria-hidden="true" tabindex="-1"></a>tunning_race_sim_anneal_results <span class="ot">&lt;-</span> workflow_tunning_set_models <span class="sc">%&gt;%</span></span>
<span id="cb228-14"><a href="workflowsets.html#cb228-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow_map</span>(</span>
<span id="cb228-15"><a href="workflowsets.html#cb228-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;tune_sim_anneal&quot;</span>,</span>
<span id="cb228-16"><a href="workflowsets.html#cb228-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">1503</span>,</span>
<span id="cb228-17"><a href="workflowsets.html#cb228-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> ames_folds,</span>
<span id="cb228-18"><a href="workflowsets.html#cb228-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">100</span>,</span>
<span id="cb228-19"><a href="workflowsets.html#cb228-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span>  <span class="fu">metric_set</span>(rmse, mae, mape, rsq),</span>
<span id="cb228-20"><a href="workflowsets.html#cb228-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> race_ctrl,</span>
<span id="cb228-21"><a href="workflowsets.html#cb228-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb228-22"><a href="workflowsets.html#cb228-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb228-23"><a href="workflowsets.html#cb228-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-24"><a href="workflowsets.html#cb228-24" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb228-25"><a href="workflowsets.html#cb228-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-26"><a href="workflowsets.html#cb228-26" aria-hidden="true" tabindex="-1"></a>tunning_race_sim_anneal_results <span class="sc">%&gt;%</span> <span class="fu">saveRDS</span>(<span class="st">&quot;models/race_sim_anneal_results.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="workflowsets.html#cb229-1" aria-hidden="true" tabindex="-1"></a>tunning_race_sim_anneal_results<span class="sc">$</span>result</span></code></pre></div>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="workflowsets.html#cb230-1" aria-hidden="true" tabindex="-1"></a>tunning_race_sim_anneal_results <span class="sc">%&gt;%</span></span>
<span id="cb230-2"><a href="workflowsets.html#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rank_results</span>(<span class="at">select_best =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb230-3"><a href="workflowsets.html#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(.config, n, preprocessor, std_err)) <span class="sc">%&gt;%</span></span>
<span id="cb230-4"><a href="workflowsets.html#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .metric, <span class="at">values_from =</span> mean)</span></code></pre></div>

<div class="watermark">
<img src="img/header.png" width="400">
</div>

<div class="watermark">
<img src="img/header.png" width="400">
</div>

</div>
</div>
</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>

$('.pipehover_incremental tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).prevAll().addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});


$('.pipehover_select_one_row tr').hover(function() {
  $(this).removeClass()
  $(this).prevAll().removeClass()
  $(this).nextAll().removeClass()
  $(this).addClass('hover');
  $(this).closest('div').next().find('img').attr("src", $(this).attr("link"));
});

</script>
            </section>

          </div>
        </div>
      </div>
<a href="bagging-boosting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["amt22_03intro2mls2.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
